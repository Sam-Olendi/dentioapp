<template name="generationEdit">
    <div class="generator-generation">

        <div class="generator-generation-top">
            <a href="/generator" class="button mod-button-generator-back"><span class="icon-arrow-left"></span>Back to Invoice List</a>
        </div>

        <div class="generator-invoice">
            <header class="generator-invoice-header">
                {{> generationEditHeader }}
            </header>

            <div class="generator-invoice-address">
                {{> generationEditAddress }}
            </div>

            <div class="generator-generation-table">
                <div class="generator-generation-table-head">
                    <div class="generator-generation-name mod-generator-generation-name-item">Service</div>
                    <div class="generator-generation-name mod-generator-generation-name-description">Description</div>
                    <div class="generator-generation-name mod-generator-generation-name-quantity">Quantity</div>
                    <div class="generator-generation-name mod-generator-generation-name-price">Price</div>
                    <div class="generator-generation-name mod-generator-generation-name-amount">Amount</div>
                </div>

                {{#each treatments}}
                    <div class="generator-generation-table-row generator-generation-table-row-edit">
                        <div class="generator-generation-cell mod-generator-generation-cell-service">
                            <span class="generator-generation-cell-edit-text">{{findService service_id}}</span>
                            <select title="" id="" class="generator-generation-select generator-generation-select-edit mod-generator-generation-select-table">
                                <option value="None">--Select a service--</option>
                                {{#each services}}
                                    <option class="generator-generation-options" value="{{_id}}">{{service_name}}</option>
                                {{/each}}
                            </select>
                        </div>
                        <div class="generator-generation-cell mod-generator-generation-cell-description">
                            <span class="generator-generation-cell-edit-text">{{description}}</span>
                            <input type="text" id="" value="{{description}}" placeholder="Service description" class="generator-generation-input generator-generation-input-edit mod-generator-generation-input-table generator-generation-input-description">
                        </div>
                        <div class="generator-generation-cell mod-generator-generation-cell-quantity">
                            {{#if quantity}}
                                <span class="generator-generation-cell-edit-text">{{quantity}}</span>
                                <input type="number" id="" value="{{quantity}}" placeholder="Quantity" class="generator-generation-input generator-generation-input-edit mod-generator-generation-input-table generator-generation-input-quantity">
                            {{else}}
                                <span class="generator-generation-cell-edit-text">1</span>
                                <input type="number" id="" value="1" placeholder="Quantity" class="generator-generation-input generator-generation-input-edit mod-generator-generation-input-table generator-generation-input-quantity">
                            {{/if}}
                        </div>
                        <div class="generator-generation-cell mod-generator-generation-cell-price">
                            {{#if price}}
                                <span class="generator-generation-cell-edit-text">{{price}}</span>
                                <input type="number" id="" value="{{price}}" placeholder="Price" class="generator-generation-input generator-generation-input-edit mod-generator-generation-input-table generator-generation-input-price">
                            {{else}}
                                <span class="generator-generation-cell-edit-text">{{amount}}</span>
                                <input type="number" id="" value="{{amount}}" placeholder="Price" class="generator-generation-input generator-generation-input-edit mod-generator-generation-input-table generator-generation-input-price">
                            {{/if}}
                        </div>
                        <div class="generator-generation-cell mod-generator-generation-cell-amount">
                            <span class="generator-generation-cell-edit-text">{{amount}}</span>
                            <input type="number" id="" value="{{amount}}" placeholder="Amount" class="generator-generation-input generator-generation-input-edit mod-generator-generation-input-table generator-generation-input-amount">
                        </div>
                        <div class="generator-generation-table-actions">
                            <a href="#" class="generator-generation-row-edit"><span title="Edit this row" class="icon-write"></span></a>
                            <a href="#" class="generator-generation-row-save"><span title="Save changes" class="icon-checkmark"></span></a>
                            <a href="#" class="generator-generation-row-delete"><span title="Remove this row" class="icon-cancel"></span></a>
                        </div>
                    </div>
                {{/each}}

            </div>

            <div class="generator-generation-controls">
                <a href="#" class="generator-generation-add-control"><span title="Add a row" class="icon-add"></span></a>
            </div>

            <div class="generator-generation-calculator">
                <div class="generator-generation-calculator-field mod-generator-generation-calculator-field-subtotal">
                    <div class="generator-generation-calculator-title">Subtotal</div>
                    <div class="generator-generation-calculator-subtotal">Kshs. {{ calculateSubtotal final_amount vat }}</div>
                </div>
                <div class="generator-generation-calculator-field mod-generator-generation-calculator-field-vat">
                    <div class="generator-generation-calculator-title">VAT</div>
                    <div class="generator-generation-calculator-input">
                        <input type="number" placeholder="VAT" value="{{vat}}" min="0" max="100" class="generator-generation-input mod-generator-generation-input-calculator"> %
                    </div>
                </div>
                <div class="generator-generation-calculator-field mod-generator-generation-calculator-field-total">
                    <div class="generator-generation-calculator-title mod-generator-generation-calculator-title-total">Total</div>
                    <div class="generator-generation-calculator-total">Kshs.{{final_amount}}</div>
                </div>
            </div>

            <div class="generator-generation-bottom">
                <a href="#" class="button mod-button-generator-go">Preview & Print</a>
                <a href="#" class="button mod-button-generator-no">Delete this invoice</a>
            </div>
        </div>


    </div>
</template>

<template name="generationEditHeader">
    <h1 class="generator-invoice-title">
        <span class="generator-invoice-title-text">Invoice #</span>
        <input type="text" value="{{ generation_no }}" placeholder="Invoice number" class="generator-generation-input mod-generator-generation-input-header" >
    </h1>
    <div class="generator-invoice-field">
        <p class="generator-invoice-field-text">Date Issued</p>
        <input type="text" value="{{convertToMomentWithoutTime date_generated}}" placeholder="Date issued" id="datepicker" class="generator-generation-input mod-generator-generation-input-header generator-generation-datepicker">
    </div>
    <div class="generator-invoice-field">
        <p class="generator-invoice-field-text">Patient Name</p>
        <input type="text" value="{{patient.profile.surname}}, {{patient.profile.first_name}} {{patient.profile.middle_name}}" placeholder="Patient name" class="generator-generation-input mod-generator-generation-input-header">
    </div>
    <div class="generator-invoice-field">
        <p class="generator-invoice-field-text">Company</p>
        <input type="text" value="{{company.company_name}}" placeholder="Company name" class="generator-generation-input mod-generator-generation-input-header">
    </div>
    <div class="generator-invoice-field">
        <p class="generator-invoice-field-text">Staff Number</p>
        <input type="text" value="{{patient.work.staff_number}}" placeholder="Staff number" class="generator-generation-input mod-generator-generation-input-header">
    </div>
</template>

<template name="generationEditAddress">
    <div class="generator-invoice-address-from">
        <p class="generator-invoice-address-title">From:</p>
        <p class="generator-invoice-address-gdc">Gentle Dental Care</p>
        <address class="generator-invoice-address-information">
            Dr. Jane Okong'o Oloo <br>
            P.O Box 33764 - 00600 <br>
            Nairobi, Kenya <br>
        </address>
        <p class="generator-invoice-address-text">Tel: 020 2219 054 / 020 2227 052 / 0722 403 340</p>
        <p class="generator-invoice-address-text">Email: oloojane@gmail.com</p>
        <p class="generator-invoice-address-text">Website: www.gentle-dentalcare.org</p>
    </div>
    <div class="generator-invoice-address-to">
        <p class="generator-invoice-address-title">To:</p>
        <!--<address class="generator-invoice-address-information">-->
        <!--{{patient.profile.surname}} {{patient.profile.middle_name}} {{patient.profile.first_name}} <br>-->
        <!--{{{patient.contacts.postal_address}}}-->
        <!--</address>-->
        <textarea name="" id="" cols="30" rows="10" placeholder="Recipient's address" class="generator-invoice-address-textarea">{{patient.profile.surname}} {{patient.profile.middle_name}} {{patient.profile.first_name}}
            {{{patient.contacts.postal_address}}}
        </textarea>
    </div>
</template>